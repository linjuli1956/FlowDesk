# FlowDesk - 企业级Windows网络管理工具

*版本标记: v2025-08-30*

FlowDesk是一个功能强大的Windows企业级网络管理工具，采用严格的分层架构和模块化设计，提供专业的网络配置、网络工具、远程桌面管理和硬件监控功能。

## 功能特性

### ✅ 网络配置 (已完整实现)
- **智能网卡管理**：支持有线/无线网卡，自动优先级排序
- **IPv4/IPv6双栈支持**：完整的IPv6地址显示与管理
- **IP配置管理**：静态IP/DHCP模式切换，智能IP分类显示
- **额外IP管理**：支持多IP配置，AddIPDialog专业对话框
- **DNS配置**：主DNS/备用DNS设置，支持多种DNS服务器
- **状态可视化**：图形化连接状态、IP模式、网卡速率实时徽章
- **信息复制功能**：格式化网卡信息到剪贴板（含时间戳）
- **实时验证**：IP地址、子网掩码、DNS输入实时验证，无干扰体验

### 🚧 网络工具 (规划开发中)
- 网络连通性测试（内置Ping工具，支持延迟阶梯颜色显示）
- 路由追踪（Traceroute功能）
- 系统工具集（9个彩色功能按钮，3×3网格布局）
- Winsock重置、防火墙Ping配置
- 密码设置功能（本机密码 + 远程桌面启用）

### 🚧 远程桌面 (规划开发中)
- RDP连接管理器（高级连接配置窗口）
- 连接历史记录（持久化存储，支持搜索）
- 分组管理和凭据安全存储
- 连接统计和智能填充功能

### 🚧 硬件监控 (规划开发中)
- 硬件信息采集（CPU、GPU、内存、硬盘等）
- 实时监控（温度、风扇转速、使用率）
- Always-on-Top透明悬浮窗
- 阶梯颜色策略和信息导出功能

## 系统要求

- **操作系统**：Windows 7/10/11 (主要支持Win10/11，Win7降级支持)
- **Python版本**：Python 3.8+
- **核心依赖**：PyQt5 5.15.x
- **权限要求**：网络配置功能需要管理员权限
- **硬件要求**：最小内存512MB，推荐1GB以上

## 安装依赖

### 自动安装（推荐）
```bash
pip install -r requirements.txt
```

### 手动安装核心依赖
```bash
pip install PyQt5>=5.15.0
```

### 完整依赖列表
- **PyQt5**: 5.15.x（UI框架）
- **subprocess**: 系统命令封装
- **json**: 配置文件处理
- **logging**: 统一日志管理
- **typing**: 类型注解支持

## 启动方式

### 推荐方式：快速启动脚本
```bash
python run.py
```

### Windows批处理启动
```bash
run.bat
```

### 模块化启动（开发模式）
```bash
cd src
python -m flowdesk
```

### 直接运行（兼容模式）
```bash
python -m src.flowdesk
```

### 调试模式启动
```bash
python run.py --debug
```

## 项目结构

```
FlowDesk/                           # 项目根目录
├── src/flowdesk/                   # 源代码目录 (3,156行)
│   ├── models/                    # 数据模型层 (419行)
│   │   ├── adapter_info.py       # 网卡信息模型 (IPv6支持)
│   │   ├── ip_config_info.py     # IP配置信息模型
│   │   ├── extra_ip.py          # 额外IP地址模型
│   │   └── dns_config.py        # DNS配置模型
│   ├── services/                  # 业务逻辑层 (3,084行)
│   │   ├── network_service.py    # 网络服务 (2,352行，核心巨型类)
│   │   ├── system_tray_service.py # 系统托盘服务 (365行)
│   │   └── stylesheet_service.py  # 样式管理服务 (完整实现)
│   ├── ui/                       # 用户界面层 (1,284行)
│   │   ├── main_window.py        # 主窗口 (430行)
│   │   ├── network_config_tab.py # 网络配置Tab (754行)
│   │   └── add_ip_dialog.py      # 添加IP对话框 (100行)
│   ├── utils/                    # 工具函数层 (466行)
│   │   ├── logger.py            # 日志管理
│   │   ├── network_utils.py     # 网络工具函数
│   │   └── validators.py        # 输入验证器
│   ├── app.py                   # 应用程序核心 (103行)
│   └── __main__.py             # 模块启动入口
├── assets/                       # 资源文件目录
│   ├── icons/                   # 图标文件 (ICO/PNG格式)
│   │   └── flowdesk.ico        # 主程序图标
│   ├── LibreHardwareMonitor/    # 硬件监控库 (12个文件)
│   └── styles/                  # QSS样式文件 (8个文件)
│       ├── main_pyqt5.qss      # 主样式文件
│       ├── main_win7.qss       # Win7兼容样式
│       ├── network_config_tab.qss # 网络配置Tab样式
│       └── add_ip_dialog.qss   # 添加IP对话框样式
├── config/                      # 配置文件目录
│   ├── development.py          # 开发环境配置
│   ├── production.py           # 生产环境配置
│   └── logging.conf           # 日志配置
├── logs/                       # 日志文件目录
├── docs/                       # 项目文档目录 (8个核心文档)
├── tests/                      # 测试用例目录
├── run.py                     # 快速启动脚本
├── run.bat                    # Windows批处理启动
└── requirements.txt           # 依赖管理文件
```

## 架构设计

FlowDesk采用严格的企业级分层架构和面向对象设计：

### 核心架构原则
- **UI层**：纯界面交互，零业务逻辑，严格遵循UI四大铁律
- **服务层**：业务逻辑处理，通过PyQt信号槽与UI通信
- **模型层**：数据结构定义、类型安全和数据验证
- **工具层**：通用功能、平台封装和安全命令执行

### 通信机制
- **信号驱动架构**：8个核心信号实现UI-服务层双向通信
- **零耦合设计**：UI层不直接调用服务层方法，完全通过信号通信
- **类型安全**：使用typing注解确保数据契约准确性

### 样式管理架构
- **StylesheetService统一管理**：8个QSS文件模块化加载
- **Win7兼容模式**：自动系统版本检测，应用对应样式
- **高特异性选择器**：解决样式优先级冲突
- **零内联样式**：禁止setStyleSheet()调用，确保样式一致性

## 核心技术特性

### 企业级开发规范
- 🎨 **UI四大铁律**：禁止样式重复、严格自适应布局、最小宽度保护、智能组件缩放
- 🏗️ **面向对象五大原则**：封装性、单一职责、开闭原则、依赖倒置、接口分离
- 📝 **详细中文注释**：面向初学者友好，描述代码作用而非修改动作
- 🔒 **类型安全设计**：全面typing注解，确保数据契约准确性

### 技术实现亮点
- 🚀 **快速启动优化**：网卡信息智能缓存，启动时间<2秒
- 🎯 **实时输入验证**：无弹窗干扰，实时禁止无效输入
- 🖼️ **图形化状态徽章**：连接状态、IP模式、网卡速率可视化显示
- 🌐 **IPv6完整支持**：双栈网络环境完美适配
- 🎨 **CLAYMORPHISM设计语言**：现代化渐变色按钮和圆角卡片
- 🔔 **系统托盘集成**：后台运行支持，右键菜单功能

### 安全与稳定性
- 🛡️ **编码安全处理**：Windows命令输出编码冲突解决
- 📊 **统一日志管理**：分级日志记录，便于问题诊断
- ⚡ **异步任务处理**：网络操作不阻塞UI响应
- 🔧 **健壮错误处理**：完善的异常捕获和用户友好提示

## 使用说明

### 网络配置Tab（已完整实现）
1. **启动初始化**：程序启动自动获取所有网卡，按连接状态智能排序
2. **网卡选择**：下拉框选择网卡，自动更新IP信息、状态徽章、当前网卡标签
3. **IP配置**：支持静态IP/DHCP切换，主IP显示在输入框，额外IP显示在列表
4. **DNS配置**：主DNS/备用DNS设置，支持常用DNS服务器
5. **额外IP管理**：点击"添加IP"弹出专业对话框，支持批量管理
6. **信息复制**：点击"复制信息"将格式化网卡信息复制到剪贴板
7. **状态刷新**：点击"刷新"按钮重新获取当前网卡最新信息

### 操作技巧
- **实时验证**：IP地址、子网掩码输入框提供实时验证，阻止无效输入
- **智能填充**：子网掩码默认填充255.255.255.0，减少用户输入
- **状态可视化**：连接状态（绿色/灰色）、IP模式、网卡速率实时显示
- **IPv6支持**：自动显示网卡所有IPv6地址，无需额外配置

## 注意事项

### 权限与兼容性
- ⚠️ **管理员权限**：IP配置修改、额外IP管理等功能需要管理员权限
- 🖥️ **系统兼容性**：主要支持Windows 10/11，Windows 7提供降级支持
- 📁 **配置目录**：首次运行会创建logs/和data/目录存储日志和配置文件

### 已知限制
- 🔧 **技术债务**：NetworkService.py为2352行巨型类，计划拆分为8个专业服务类
- 🚧 **开发状态**：网络工具、远程桌面、硬件监控Tab仍在规划开发中
- 🎯 **性能优化**：大量网卡环境下可能存在响应延迟，已有优化方案

### 最佳实践建议
- 💡 **首次使用**：建议以管理员身份运行，确保所有功能正常工作
- 🔄 **定期更新**：关注项目更新，新功能持续开发中
- 📞 **技术支持**：遇到问题查看logs/目录下的日志文件进行诊断

## 开发路线图

### v1.0（当前版本）- 网络配置核心功能
- ✅ **网络配置Tab**：完整实现8个核心功能模块
- ✅ **StylesheetService**：模块化样式管理架构
- ✅ **数据模型层**：AdapterInfo、IPConfigInfo、ExtraIP、DnsConfig
- ✅ **系统托盘集成**：后台运行和右键菜单支持

### v1.5（中期目标）- 服务拆分与新Tab开发
- 🎯 **NetworkService重构**：拆分为8个专业服务类
- 🎯 **网络工具Tab**：Ping、Traceroute、9个系统工具按钮
- 🎯 **远程桌面Tab**：RDP连接管理器和历史记录

### v2.0（长期愿景）- 集中化管理平台
- 🎯 **硬件监控Tab**：实时监控和透明悬浮窗
- 🎯 **屏幕墙功能**：多台服务器并行监控
- 🎯 **资产信息上报**：企业级设备管理集成

## 技术文档

- 📋 **开发路线图与优先级.md**：详细功能规划和时间节点
- 🏗️ **项目架构设计说明书.md**：分层架构和设计原则
- 📊 **数据流与状态管理设计.md**：信号机制和数据流向
- 🌐 **网络配置Tab核心功能实现总结.md**：技术实现细节
- 📁 **目录结构说明.md**：项目文件组织和模块职责
- 🎨 **UI组件与样式规范(CLAYMORPHISM).md**：界面设计指南

## 许可证

本项目采用 **企业学习研究许可证**，仅供学习和研究使用，不得用于商业用途。

---

**FlowDesk** - 让网络管理更专业、更高效 🚀
